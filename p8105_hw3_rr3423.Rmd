---
title: "p8105_hw3_rr3423.Rmd"
author: "Ragyie Rawal"
date: "10/13/2021"
output: github_document
---

```{r setup, include = FALSE}
library(tidyverse)
library(p8105.datasets)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```


## PROBLEM 1

### Loading Instacart dataset from p8105.datasets 

```{r load_instacart}
data("instacart")
```

### Cleaning variable names in Instacart datacart 

```{r cleaning_instacart}
instacart_df = 
  instacart %>% 
  janitor::clean_names()
```

### Dataset exploration 

```{r data_exploration_instacart}
rows_instacart = instacart_df %>% nrow()
cols_instacart = instacart_df %>% ncol()
names_instacart = instacart_df %>% names()
```

The number of **rows** in the instacart dataset are **`r rows_instacart`**. The number of **columns** in the instacart dataset are **`r cols_instacart`**. The **key variables** in the instacart dataset are **`r names_instacart`**. 

### Aisles 

How many aisles are there, and which aisles are the most items ordered from? 

```{r aisles_instacart}
instacart_df %>% 
  group_by(aisle) %>% 
  summarize(item_count = n()) %>% 
  arrange(desc(item_count))
```

There are 134 aisles in the instacart dataset. The top 3 aisles that the most items are ordered from in descending order are: "fresh vegetables", "fresh fruits", and "packaged vegetables fruits". 

### Plot of the number of items ordered in each aisle (more than 10000 items)

```{r aisles_plot_instacart}
plot_aisle = 
  instacart_df %>% 
  group_by(aisle) %>% 
  summarize(item_count = n()) %>% 
  filter(item_count > 10000) %>% 
  ggplot(aes(x = reorder(aisle, item_count), y = item_count)) +
  geom_bar(stat = "identity") +
  coord_flip() + 
  labs(
    title = "Number of items ordered in each aisle",
    x = "Aisle name",
    y = "Items ordered",
    caption = "Limited to aisles with >10000 items"
  ) + 
  theme(axis.text.y = element_text(size = 7))

plot_aisle
```

This plot also shows that the top 3 aisles that the most items are ordered from in descending order are: "fresh vegetables", "fresh fruits", and "packaged vegetables fruits". 

### Table of three most popular items in each of the aisles "baking ingredients", "dog food care", "packaged vegetables fruits"

```{r popular_items_table, message = FALSE, warning = FALSE}
table_popular_items = 
  instacart_df %>% 
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  group_by(aisle, product_name) %>% 
  summarize(item_count = n()) %>% 
  filter(min_rank(desc(item_count)) < 4) %>% 
  arrange(desc(item_count), .by_group = TRUE) 
  
knitr::kable(table_popular_items)
```

This table shows that the top three popular items in the "baking ingredients" aisle are: Light Brown Sugar with 499 items ordered, Pure Baking Soda with 387 times ordered, and Cane Sugar with 336 times ordered. The top three popular items in the "dog food care" aisle are: Snack Sticks Chicken & Rice Recipe Dog Treats with 30 times ordered, Organix Chicken & Brown Rice Recipe with 28 times ordered, and Small Dog Biscuits with 26 times ordered. The top three popular items in the "packaged vegetables fruits" aisle are: Organic Baby Spinach with 9784 times ordered, Organic Raspberries with 5546 times ordered, and Organic Blueberries with 4966 times ordered. 

